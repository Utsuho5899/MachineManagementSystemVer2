@model MachineManagementSystemVer2.ViewModels.TimelineEntry
@using MachineManagementSystemVer2.ViewModels

@{
    var entryClass = "";
    if (Model.Type == TimelineEntry.EntryType.Initial)
    {
        entryClass = "timeline-initial-desc";
    }
}

<div class="timeline-entry @entryClass" data-timestamp="@Model.Timestamp.Ticks">
    @if (Model.Type == TimelineEntry.EntryType.StatusChange)
    {
        <div class="fst-italic text-muted">
            狀態從 <span class="badge bg-secondary">@Model.OldStatus</span> 變更為 <span class="badge bg-primary">@Model.NewStatus</span>
        </div>
    }
    else
    {
        <p class="mb-0" style="white-space: pre-wrap;">@Model.Content</p>

        @if (Model.Photos.Any())
        {
            <div class="mt-3 d-flex flex-wrap">
                @foreach (var photo in Model.Photos)
                {
                    <div style="margin-right: 10px; margin-bottom: 10px;">
                        <a href="#" data-bs-toggle="modal" data-bs-target="#imageModal" data-bs-imgsrc="data:image;base64,@Convert.ToBase64String(photo.PhotoData)">
                            <img src="data:image;base64,@Convert.ToBase64String(photo.PhotoData)" class="img-thumbnail" style="max-height: 150px; cursor: pointer;" alt="@photo.FileName">
                        </a>
                    </div>
                }
            </div>
        }
    }
    <div class="timeline-entry-footer">
        @Model.Author 於 @Model.Timestamp.ToString("yyyy-MM-dd HH:mm")
    </div>
</div>